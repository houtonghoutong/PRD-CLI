# P0 文档填写流程修复报告

**修复时间**: 2025-12-19  
**版本**: 1.1.1 → 1.1.2（待发布）  
**修复类型**: 工作流优化

---

## 📌 问题描述

### 用户反馈

用户在初始化项目时，系统没有引导他完善 P0_项目基本信息.md，而是直接跳到了 A0 文档的创建。

### 问题根源

1. **`init.js` 提示不明确**：初始化成功后，只提示"创建 A0"，没有强调先完善 P0
2. **缺少 P0 填写工作流文档**：没有专门的工作流指引如何填写 P0
3. **文档填写工作流未提及 P0**：`prd-document-filling.md` 没有说明 P0 是前置要求

### 影响范围

- 用户可能跳过 P0 直接创建 A0，导致项目基础信息缺失
- AI 无法理解项目背景和目标
- 后续规划可能偏离项目初衷

---

## 🔧 修复方案

### 1. 优化 `init.js` 的提示信息

**文件**: `/prd-cli/commands/init.js`

**修改内容**:
- 增加明确的分步指引（第 1 步、第 2 步、第 3 步）
- 强调第 2 步必须完善 P0_项目基本信息.md
- 添加警告提示：⚠️ 必须完成 P0 填写后才能开始创建 A 类基线文档
- 说明 P0 文件位置和需要填写的内容

**修改前**:
```javascript
console.log(chalk.green('✓ 项目创建成功!'));
console.log('');
console.log(chalk.bold('下一步操作:'));
console.log(`  cd ${projectName}`);
console.log('  prd baseline create A0  # 开始创建基线文档');
console.log('');
```

**修改后**:
```javascript
console.log(chalk.green('✓ 项目创建成功!'));
console.log('');
console.log(chalk.bold('📋 下一步操作（请按顺序执行）:'));
console.log('');
console.log(chalk.cyan('第 1 步: 进入项目目录'));
console.log(`  cd ${projectName}`);
console.log('');
console.log(chalk.cyan('第 2 步: 完善 P0_项目基本信息.md'));
console.log(chalk.gray('  文件位置: 00_项目总览/P0_项目基本信息.md'));
console.log(chalk.gray('  填写内容: 项目目标、干系人、约束条件等'));
console.log(chalk.yellow('  ⚠️  必须完成 P0 填写后才能开始创建 A 类基线文档'));
console.log('');
console.log(chalk.cyan('第 3 步: 创建 A0 基线文档'));
console.log('  prd baseline create A0  # P0 填写完成后执行');
console.log('');
```

### 2. 创建 P0 填写工作流文档

**新建文件**: `/prd-cli/.agent/workflows/prd-p0-project-info.md`

**内容包括**:
- P0 文档的定位和作用
- P0 与 A 类文档的关系
- 填写时机和执行顺序
- 详细的填写流程（5 个步骤）
- AI 检查清单
- 完成标志
- 常见错误与纠正
- AI 与 PM 的对话示例

**核心流程**:
1. 项目基本信息（项目定位、级别）
2. 项目目标（核心问题、成功标准）
3. 干系人（PM、技术负责人、业务方）
4. 项目约束（时间、资源、依赖）
5. PM 确认（勾选清单）

### 3. 更新文档填写工作流

**文件**: `/prd-cli/.agent/workflows/prd-document-filling.md`

**修改内容**:
- 在开头增加"重要前置要求"章节
- 明确 P0 必须先完成
- 提供 AI 提醒模板（当检测到 P0 未完善时）
- 引用 P0 填写工作流（`/prd-p0-project-info`）

**新增内容**:
```markdown
## ⚠️ 重要前置要求：P0 必须先完成

**在填写任何 B 类或 C 类文档之前，必须确认以下文档已完成：**

1. ✅ **P0_项目基本信息.md** 已完善（项目初始化后的第一步）
2. ✅ **A0_产品基础与范围说明.md** 已创建
3. ✅ **A1_已上线功能与流程清单.md** 已创建（如适用）
4. ✅ **A2_存量反馈与数据汇总.md** 已创建（如适用）

**如果 P0 未完成，AI 必须提醒 PM**：
...
```

---

## ✅ 修复效果

### 修复前的用户体验

1. 执行 `prd init myproject`
2. 看到提示：`prd baseline create A0  # 开始创建基线文档`
3. 直接执行 `prd baseline create A0`
4. ❌ 跳过了 P0 的填写

### 修复后的用户体验

1. 执行 `prd init myproject`
2. 看到明确的分步指引：
   - 第 1 步：进入项目目录
   - 第 2 步：完善 P0_项目基本信息.md（⚠️ 强调必须完成）
   - 第 3 步：创建 A0 基线文档
3. 打开并完善 P0 文档
4. ✅ 完成 P0 后再执行 `prd baseline create A0`

### AI 引导改进

**场景 1**: 用户尝试在 P0 未完成时创建 B1

```
用户: "帮我填写 B1 规划文档"

AI: "⚠️ 检测到 P0_项目基本信息尚未完善。

     P0 是整个 PRD 体系的起点，必须先完成才能开始 B 类文档填写。
     
     请先完善以下内容：
     - 项目目标（可衡量的成功标准）
     - 干系人信息（具体到人和联系方式）
     - 项目约束（时间、资源、依赖）
     
     完成后再继续填写 B1。
     
     参考工作流：/prd-p0-project-info"
```

**场景 2**: 用户初次填写 P0

```
用户: "怎么填写 P0 文档？"

AI: "让我们一起完善 P0 项目基本信息。首先明确项目定位：

     1. 项目全称是什么？
     2. 用一句话描述这个项目是什么？
     3. 这个项目属于哪个产品线？
     4. 项目级别是什么？（战略级/业务级/支撑级）"
```

---

## 📊 关键改进点

| 改进项 | 修复前 | 修复后 |
|--------|--------|--------|
| 初始化提示 | 只提示创建 A0 | 明确分步指引，强调先完善 P0 |
| P0 填写工作流 | 不存在 | 新建完整工作流文档 |
| 文档填写工作流 | 无 P0 前置要求说明 | 增加前置要求检查 |
| AI 引导 | 无检查机制 | 检测到 P0 未完善时主动提醒 |
| 用户体验 | 容易跳过 P0 | 明确流程，不易遗漏 |

---

## 🚀 后续建议

### 短期优化（本次修复已包含）

1. ✅ 优化 `init.js` 提示信息
2. ✅ 创建 P0 填写工作流文档
3. ✅ 更新文档填写工作流

### 中期优化（可考虑）

1. **增加 P0 完成度检查命令**
   ```bash
   prd check p0
   ```
   - 检查 P0 是否完整填写
   - 检查成功标准是否可衡量
   - 检查干系人信息是否完整

2. **在创建 A0 时检查 P0**
   ```javascript
   // baseline.js 中增加检查
   if (type === 'A0') {
       const p0Path = path.join(process.cwd(), '00_项目总览/P0_项目基本信息.md');
       const p0Content = await fs.readFile(p0Path, 'utf-8');
       
       if (hasUnfilledSections(p0Content)) {
           console.log(chalk.yellow('⚠️ P0 项目基本信息尚未完善'));
           console.log('建议先完善 P0 后再创建 A0');
           // 询问用户是否继续
       }
   }
   ```

3. **增加 P0 自检提示**
   - 在 P0 模板中增加自检清单链接
   - 提供 AI 辅助填写的示例对话

### 长期优化（可探索）

1. **交互式 P0 填写向导**
   ```bash
   prd p0 wizard
   ```
   - 通过命令行问答引导填写 P0
   - 自动验证必填项
   - 生成结构化的 P0 文档

2. **P0 质量评分**
   - 评估目标是否可衡量
   - 检查干系人信息完整度
   - 给出改进建议

---

## 📝 总结

本次修复通过以下三个方面的改进，确保用户不会跳过 P0 填写步骤：

1. **明确的初始化提示**：分步指引，强调 P0 优先
2. **完整的 P0 填写工作流**：提供详细的填写指引和示例
3. **工作流文档的前置检查**：AI 主动提醒 P0 未完成

这些改进将显著提升用户体验，确保项目从一开始就建立在清晰的目标和完整的基础信息之上。

---

**修复完成时间**: 2025-12-19  
**修复人员**: AI Assistant  
**待发布版本**: 1.1.2
