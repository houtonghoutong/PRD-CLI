# PRD CLI 版本更新指南

## 📦 版本更新方法

### 方法 1：直接更新（推荐）✨

```bash
# 全局更新到最新版本
npm install -g prd-workflow-cli@latest

# 或指定版本号
npm install -g prd-workflow-cli@1.1.8
```

这会自动覆盖旧版本。

---

### 方法 2：先卸载再安装

```bash
# 1. 卸载旧版本
npm uninstall -g prd-workflow-cli

# 2. 安装新版本
npm install -g prd-workflow-cli@latest
```

---

### 方法 3：本地开发包更新

如果你是从本地安装的（使用 `.tgz` 文件）：

```bash
# 1. 打包新版本
cd /Users/hou/Documents/UGit/PRD-CLI/prd-cli
npm pack

# 2. 安装新打包的文件
npm install -g prd-workflow-cli-1.1.8.tgz
```

---

## 🔍 检查当前版本

### 查看已安装的版本

```bash
npm list -g prd-workflow-cli
```

### 查看可用的最新版本

```bash
npm view prd-workflow-cli version
```

---

## ⚠️ 更新前的注意事项

### 1. 备份重要项目
如果你的项目正在使用旧版本，建议先备份：

```bash
# 备份项目
cp -r 你的项目目录 你的项目目录_backup
```

### 2. 查看版本变更
阅读 CHANGELOG.md 了解新版本的变化：

```bash
cat CHANGELOG.md | head -50
```

### 3. 检查兼容性
- v1.1.8 与 v1.1.7 **完全兼容**
- 新增了测试框架，不影响现有项目
- 修复了文件名检查bug，使工作更稳定

---

## 📋 更新后验证

### 1. 验证版本号

```bash
npm list -g prd-workflow-cli
# 应该显示：prd-workflow-cli@1.1.8
```

### 2. 测试基本命令

```bash
# 在一个测试目录中
prd init test-project
cd test-project
prd baseline create A0
```

### 3. 运行测试（如果需要）

```bash
# 进入安装目录
cd $(npm root -g)/prd-workflow-cli

# 运行测试
npm run test:cn
```

---

## 🔄 项目迁移指南

### 现有项目如何使用新版本？

**好消息：不需要迁移！** ✅

新版本（v1.1.8）与旧版本（v1.1.7）完全兼容：

1. ✅ 所有命令保持不变
2. ✅ 文档结构保持不变
3. ✅ 工作流程保持不变
4. ✅ 只是增强了内部检查和测试

### 唯一的改进

新版本修复了一些文件名检查的bug，使得：
- `prd plan create B1` 检查更准确
- `prd review r1` 前置条件更严格
- 防止了R0-R1流程跳跃问题

这些改进**只会让工作更安全**，不会破坏现有项目。

---

## 🚀 快速更新脚本

创建一个更新脚本 `update-prd-cli.sh`：

```bash
#!/bin/bash

echo "🔄 开始更新 PRD CLI..."

# 显示当前版本
echo "📦 当前版本："
npm list -g prd-workflow-cli

# 更新到最新版本
echo "⬆️  正在更新..."
npm install -g prd-workflow-cli@latest

# 显示新版本
echo "✅ 更新后版本："
npm list -g prd-workflow-cli

echo "🎉 更新完成！"
```

使用方法：
```bash
chmod +x update-prd-cli.sh
./update-prd-cli.sh
```

---

## ❓ 常见问题

### Q1: 更新后会影响现有项目吗？
**A:** 不会。新版本完全向后兼容。

### Q2: 需要重新初始化项目吗？
**A:** 不需要。现有项目可以直接使用新版本。

### Q3: 测试框架是必需的吗？
**A:** 不是。测试框架仅用于开发验证，不影响日常使用。

### Q4: 如何回退到旧版本？
**A:** 
```bash
npm install -g prd-workflow-cli@1.1.7
```

### Q5: 更新失败怎么办？
**A:** 
```bash
# 清除缓存
npm cache clean --force

# 重新安装
npm install -g prd-workflow-cli@latest
```

---

## 📞 获取帮助

如果更新过程中遇到问题：

1. 查看 CHANGELOG.md
2. 运行 `prd --help`
3. 检查 GitHub Issues

---

**建议：定期更新到最新版本，以获得最佳的稳定性和新功能！** 🚀
