<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRD A2UI È¢ÑËßàÂô® - Ant Design</title>
    <!-- React -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <!-- Ant Design -->
    <link rel="stylesheet" href="https://unpkg.com/antd@5/dist/reset.css">
    <script src="https://unpkg.com/dayjs@1/dayjs.min.js"></script>
    <script src="https://unpkg.com/antd@5/dist/antd.min.js"></script>
    <!-- Icons -->
    <script src="https://unpkg.com/@ant-design/icons@5/dist/index.umd.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 24px;
            background: #f5f5f5;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        #root {
            max-width: 1400px;
            margin: 0 auto;
        }

        .page-header {
            margin-bottom: 16px;
        }

        .page-title {
            font-size: 20px;
            font-weight: 600;
            color: rgba(0, 0, 0, 0.88);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-bar {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 1000;
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #52c41a;
        }

        .loading-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 400px;
        }
    </style>
</head>

<body>
    <div id="root"></div>
    <div class="status-bar">
        <span class="status-dot"></span>
        <span id="status-text">ËøûÊé•‰∏≠...</span>
    </div>

    <script>
        const {
            ConfigProvider, App, Card, Button, Input, Select, Table, Tabs, Tag, Badge,
            Space, Row, Col, Typography, Divider, Alert, Upload, Form, message
        } = antd;
        const { Title, Text, Paragraph } = Typography;
        const { TextArea } = Input;
        const { PlusOutlined, EditOutlined, CopyOutlined, DeleteOutlined, SearchOutlined, ReloadOutlined, UploadOutlined, InboxOutlined } = icons;
        const { Dragger } = Upload;

        // Ê∏≤ÊüìÂô®ÁªÑ‰ª∂
        const A2UIRenderer = ({ data }) => {
            if (!data) {
                return React.createElement('div', { className: 'loading-container' },
                    React.createElement(antd.Spin, { size: 'large', tip: 'Á≠âÂæÖ A2UI Êï∞ÊçÆ...' })
                );
            }

            const renderNode = (node) => {
                if (!node) return null;

                const { type, children, ...props } = node;

                switch (type) {
                    case 'Page':
                        return React.createElement('div', { key: props.id },
                            props.title && React.createElement('div', { className: 'page-header' },
                                React.createElement('h1', { className: 'page-title' }, 'üìã ', props.title)
                            ),
                            children && children.map((child, i) => renderNode({ ...child, key: i }))
                        );

                    case 'Panel':
                        return React.createElement(Card, {
                            key: props.key,
                            title: props.title,
                            extra: props.extra && React.createElement(Space, null,
                                props.extra.map((btn, i) =>
                                    React.createElement(Button, {
                                        key: i,
                                        type: btn.variant === 'primary' ? 'primary' : 'default',
                                        icon: btn.icon === 'plus' ? React.createElement(PlusOutlined) : null
                                    }, btn.text || btn)
                                )
                            ),
                            style: { marginBottom: 16 }
                        }, children && children.map((child, i) => renderNode({ ...child, key: i })));

                    case 'Row':
                        return React.createElement(Row, { key: props.key, gutter: 16 },
                            children && children.map((child, i) => renderNode({ ...child, key: i }))
                        );

                    case 'Col':
                        return React.createElement(Col, { key: props.key, flex: 1 },
                            children && children.map((child, i) => renderNode({ ...child, key: i }))
                        );

                    case 'Input':
                        return React.createElement(Form.Item, {
                            key: props.key,
                            label: props.label,
                            required: props.required,
                            style: { marginBottom: 16 }
                        }, React.createElement(Input, { placeholder: props.placeholder }));

                    case 'Textarea':
                        return React.createElement(Form.Item, {
                            key: props.key,
                            label: props.label,
                            style: { marginBottom: 16 }
                        }, React.createElement(TextArea, { placeholder: props.placeholder, rows: props.rows || 4 }));

                    case 'Select':
                        const options = (props.options || []).map(opt => ({
                            value: typeof opt === 'string' ? opt : opt.value,
                            label: typeof opt === 'string' ? opt : opt.label
                        }));
                        return React.createElement(Form.Item, {
                            key: props.key,
                            label: props.label,
                            style: { marginBottom: 16 }
                        }, React.createElement(Select, {
                            placeholder: 'ËØ∑ÈÄâÊã©',
                            options: options,
                            style: { width: '100%' }
                        }));

                    case 'Button':
                        const btnType = props.variant === 'secondary' ? 'default' :
                            props.variant === 'danger' ? 'primary' :
                                props.variant === 'link' ? 'link' : 'primary';
                        const danger = props.variant === 'danger';
                        return React.createElement(Button, {
                            key: props.key,
                            type: btnType,
                            danger: danger,
                            icon: props.icon === 'plus' ? React.createElement(PlusOutlined) :
                                props.icon === 'search' ? React.createElement(SearchOutlined) : null,
                            style: { marginRight: 8 }
                        }, props.text);

                    case 'Text':
                        return React.createElement(Text, { key: props.key, style: { display: 'block', marginBottom: 8 } }, props.content);

                    case 'Tabs':
                        const items = (props.items || []).map((item, i) => ({
                            key: String(i),
                            label: item
                        }));
                        return React.createElement(Tabs, { key: props.key, items: items, style: { marginBottom: 16 } });

                    case 'Table':
                        const columns = (props.columns || []).map(col => {
                            const column = {
                                key: col.key || col,
                                dataIndex: col.key || col,
                                title: col.title || col
                            };

                            if (col.type === 'link') {
                                column.render = (text) => React.createElement('a', null, text);
                            } else if (col.type === 'badge') {
                                column.render = (text) => {
                                    const colorMap = col.variantMap || {};
                                    const color = colorMap[text] === 'success' ? 'green' :
                                        colorMap[text] === 'warning' ? 'orange' :
                                            colorMap[text] === 'danger' ? 'red' : 'blue';
                                    return React.createElement(Tag, { color: color }, text);
                                };
                            } else if (col.type === 'status') {
                                column.render = (text) => React.createElement(Badge, {
                                    status: text === 'Â∑≤ÂèëÂ∏É' ? 'success' : 'default',
                                    text: text
                                });
                            } else if (col.type === 'actions') {
                                column.render = () => React.createElement(Space, null,
                                    React.createElement('a', null, 'ÁºñËæë'),
                                    React.createElement('a', null, 'Â§çÂà∂'),
                                    React.createElement('a', { style: { color: '#ff4d4f' } }, 'Âà†Èô§')
                                );
                            }
                            return column;
                        });

                        const dataSource = (props.data || []).map((row, i) => ({ ...row, key: i }));

                        return React.createElement(Table, {
                            key: props.key,
                            columns: columns,
                            dataSource: dataSource,
                            pagination: false,
                            size: 'middle'
                        });

                    case 'Badge':
                        const tagColor = props.variant === 'success' ? 'green' :
                            props.variant === 'warning' ? 'orange' :
                                props.variant === 'danger' ? 'red' : 'blue';
                        return React.createElement(Tag, { key: props.key, color: tagColor }, props.text);

                    case 'Card':
                        return React.createElement(Card, {
                            key: props.key,
                            size: 'small',
                            style: { marginBottom: 12 }
                        },
                            React.createElement(Row, { justify: 'space-between', align: 'middle' },
                                React.createElement(Col, null,
                                    React.createElement(Space, { direction: 'vertical', size: 0 },
                                        React.createElement(Text, { strong: true }, props.title),
                                        props.tags && React.createElement(Space, { size: 4 },
                                            props.tags.map((tag, i) =>
                                                React.createElement(Tag, { key: i, color: tag.variant === 'success' ? 'green' : 'blue' }, tag.text)
                                            )
                                        ),
                                        props.status && React.createElement(Badge, {
                                            status: props.status === 'Â∑≤ÂèëÂ∏É' ? 'success' : 'default',
                                            text: props.status
                                        })
                                    )
                                ),
                                props.actions && React.createElement(Col, null,
                                    React.createElement(Space, null,
                                        props.actions.map((action, i) =>
                                            React.createElement(Button, { key: i, size: 'small' }, action.text || action)
                                        )
                                    )
                                )
                            )
                        );

                    case 'Upload':
                        return React.createElement(Dragger, { key: props.key },
                            React.createElement('p', { className: 'ant-upload-drag-icon' },
                                React.createElement(InboxOutlined)
                            ),
                            React.createElement('p', { className: 'ant-upload-text' }, props.text || 'ÁÇπÂáªÊàñÊãñÊãΩÊñá‰ª∂Âà∞Ê≠§Â§Ñ‰∏ä‰º†'),
                            React.createElement('p', { className: 'ant-upload-hint' }, props.hint || 'ÊîØÊåÅÂçï‰∏™ÊàñÊâπÈáè‰∏ä‰º†')
                        );

                    case 'Divider':
                        return React.createElement(Divider, { key: props.key });

                    case 'Alert':
                        const alertType = props.variant === 'danger' ? 'error' : props.variant || 'info';
                        return React.createElement(Alert, {
                            key: props.key,
                            type: alertType,
                            message: props.content || props.text,
                            showIcon: true,
                            style: { marginBottom: 16 }
                        });

                    // Êû∂ÊûÑÂõæÁªÑ‰ª∂
                    case 'Diagram':
                        return React.createElement('div', {
                            key: props.key,
                            style: {
                                background: 'linear-gradient(135deg, #1677ff 0%, #722ed1 100%)',
                                borderRadius: 8,
                                padding: 32,
                                minHeight: 300
                            }
                        },
                            props.title && React.createElement('div', {
                                style: { color: 'white', fontSize: 18, fontWeight: 600, textAlign: 'center', marginBottom: 24 }
                            }, props.title),
                            React.createElement('div', {
                                style: { display: 'flex', flexDirection: 'column', alignItems: 'center', gap: 16 }
                            }, children && children.map((child, i) => renderNode({ ...child, key: i })))
                        );

                    case 'Box':
                        return React.createElement(Card, {
                            key: props.key,
                            size: 'small',
                            style: {
                                minWidth: 120,
                                textAlign: 'center',
                                borderLeft: props.color ? `3px solid ${props.color}` : undefined
                            }
                        },
                            React.createElement(Text, { strong: true }, props.title),
                            props.desc && React.createElement('div', null,
                                React.createElement(Text, { type: 'secondary', style: { fontSize: 12 } }, props.desc)
                            )
                        );

                    case 'Arrow':
                        const arrow = props.direction === 'up' ? '‚Üë' :
                            props.direction === 'left' ? '‚Üê' :
                                props.direction === 'right' ? '‚Üí' : '‚Üì';
                        return React.createElement('div', {
                            key: props.key,
                            style: { color: 'white', fontSize: 24, textAlign: 'center' }
                        }, arrow, props.label && React.createElement('span', { style: { fontSize: 12, marginLeft: 8 } }, props.label));

                    case 'Layer':
                        return React.createElement('div', {
                            key: props.key,
                            style: { display: 'flex', flexWrap: 'wrap', gap: 12, justifyContent: 'center', width: '100%' }
                        },
                            props.title && React.createElement('div', {
                                style: { width: '100%', textAlign: 'center', color: 'rgba(255,255,255,0.8)', fontSize: 12, marginBottom: 8 }
                            }, props.title),
                            children && children.map((child, i) => renderNode({ ...child, key: i }))
                        );

                    case 'DiagramGroup':
                        return React.createElement('div', {
                            key: props.key,
                            style: {
                                background: 'rgba(255,255,255,0.1)',
                                border: '1px dashed rgba(255,255,255,0.3)',
                                borderRadius: 8,
                                padding: 16,
                                width: '100%'
                            }
                        },
                            props.title && React.createElement('div', {
                                style: { color: 'rgba(255,255,255,0.9)', fontSize: 14, marginBottom: 12 }
                            }, props.title),
                            React.createElement('div', {
                                style: { display: 'flex', flexWrap: 'wrap', gap: 12, justifyContent: 'center' }
                            }, children && children.map((child, i) => renderNode({ ...child, key: i })))
                        );

                    default:
                        console.warn('Unknown component:', type);
                        return React.createElement(Alert, {
                            key: props.key,
                            type: 'warning',
                            message: `Êú™Áü•ÁªÑ‰ª∂: ${type}`,
                            style: { marginBottom: 16 }
                        });
                }
            };

            return React.createElement(ConfigProvider, {
                theme: {
                    token: {
                        colorPrimary: '#1677ff',
                        borderRadius: 6
                    }
                }
            }, renderNode(data));
        };

        // ‰∏ªÂ∫îÁî®
        let currentData = null;
        let lastDataStr = '';

        function render() {
            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(React.createElement(A2UIRenderer, { data: currentData }));
        }

        async function checkUpdate() {
            try {
                const res = await fetch('/ui.json');
                if (res.ok) {
                    const data = await res.json();
                    const dataStr = JSON.stringify(data);

                    if (dataStr !== lastDataStr) {
                        lastDataStr = dataStr;
                        currentData = data;
                        render();
                    }

                    document.getElementById('status-text').textContent = 'Â∑≤ËøûÊé•';
                    document.querySelector('.status-dot').style.background = '#52c41a';
                }
            } catch (e) {
                document.getElementById('status-text').textContent = 'ËøûÊé•Â§±Ë¥•';
                document.querySelector('.status-dot').style.background = '#ff4d4f';
            }
        }

        // ÂàùÂßãÂåñ
        render();
        setInterval(checkUpdate, 1000);
        checkUpdate();
    </script>
</body>

</html>