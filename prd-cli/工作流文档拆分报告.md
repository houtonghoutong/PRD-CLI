# 工作流文档拆分报告

**拆分时间**: 2025-12-19  
**拆分目的**: 提高工作流文档的组织性和可用性

---

## 📌 拆分背景

### 问题

原有的工作流文档结构不一致：
- ✅ P0 和 R 类文档（R0/R1/R2）有独立工作流文档
- ❌ A/B/C 类文档都挤在一个大文档里（`prd-document-filling.md`，29KB）

### 影响

1. **文档过大**：`prd-document-filling.md` 已达 29KB，不易查找
2. **不够突出**：B1/B2/C1 的工作流容易被忽略
3. **组织不一致**：有的文档类型有独立说明，有的没有

---

## ✅ 拆分方案

### 新建的独立工作流文档

| 文档 | 文件名 | 大小 | 描述 |
|-----|--------|------|------|
| B1 | `prd-b1-planning-draft.md` | ~10KB | B1 需求规划草案填写工作流 |
| B2 | `prd-b2-planning-breakdown.md` | ~9KB | B2 规划拆解与范围界定工作流 |
| C1 | `prd-c1-requirement-list.md` | ~12KB | C1 版本需求清单填写工作流 |

### 拆分后的文档结构

```
.agent/workflows/
├── prd-p0-project-info.md          # P0 项目基本信息
├── prd-r0-baseline-review.md       # R0 基线审视
├── prd-b1-planning-draft.md        # B1 规划草案 ← 新建
├── prd-b2-planning-breakdown.md    # B2 规划拆解 ← 新建
├── prd-r1-review.md                # R1 规划审视
├── prd-c1-requirement-list.md      # C1 需求清单 ← 新建
├── prd-r2-review.md                # R2 版本审视
├── prd-c2-change-tracking.md       # C2 变更追踪
├── prd-document-filling.md         # 通用填写原则（保留）
└── ...
```

---

## 📊 拆分内容对比

### `prd-b1-planning-draft.md` - B1 规划草案

**包含内容**：
- 🚨 B1 创建时的强制启动检查
- AI 行为红线
- 正确/错误示例对比
- Step 1: 以终为始 - 明确目标
- Step 2: Gap 分析 - 基于 A 类现状
- Step 3: 明确"不做什么"
- Step 4: 分段写入
- 苏格拉底式引导示例
- AI 自查清单

**核心价值**：
- 确保 AI 不会在未与 PM 对话时填充内容
- 引导 PM 区分手段与目标
- 强制进行 Gap 分析和范围收敛

---

### `prd-b2-planning-breakdown.md` - B2 规划拆解

**包含内容**：
- 🚨 B2 创建时的强制启动检查
- AI 行为红线（禁止替 PM 决定优先级）
- Step 1: 结构化拆解 - MECE 原则
- Step 2: 识别 CSF（关键成功因素）
- Step 3: 范围界定 - 多维决策矩阵
- Step 4: 分段写入
- 优先级决策指南（P0/P1/P2）
- 常见错误与纠正

**核心价值**：
- 用 MECE 原则确保需求完整性
- 让 PM 决定所有优先级和范围
- 构建决策矩阵辅助决策
- 避免范围膨胀

---

### `prd-c1-requirement-list.md` - C1 需求清单

**包含内容**：
- 🚨 C1 创建时的强制启动检查
- AI 行为红线（禁止省略细节）
- Step 1: 严格映射检查（与 B3 对应）
- Step 2: 逐项细化（8 个维度）
  1. 需求背景
  2. 需求描述
  3. 业务规则
  4. 验收标准
  5. 边界情况
  6. 非功能需求
  7. 特殊说明
  8. 附加信息
- 完整记录示例
- AI 检查清单

**核心价值**：
- 确保 C1 不新增 B3 范围外的需求
- 完整记录所有细节（C1 是 AODW 的输入源）
- 8 个维度确保需求完整性
- 禁止省略或简化

---

## 🎯 拆分优点

### 1. 结构清晰

每个文档类型都有独立的工作流说明：

- P0 → `prd-p0-project-info.md`
- R0 → `prd-r0-baseline-review.md`
- B1 → `prd-b1-planning-draft.md`
- B2 → `prd-b2-planning-breakdown.md`
- R1 → `prd-r1-review.md`
- C1 → `prd-c1-requirement-list.md`
- R2 → `prd-r2-review.md`
- C2 → `prd-c2-change-tracking.md`

### 2. 易于查找

AI 和用户可以直接定位到具体文档，无需在大文档中搜索。

### 3. 职责明确

每个工作流只关注一个文档类型：
- B1 工作流 → 只管 B1 的填写
- B2 工作流 → 只管 B2 的拆解
- C1 工作流 → 只管 C1 的细化

### 4. 一致性

所有重要文档都有专门的工作流指引，不再有"有的有，有的没有"的问题。

### 5. 维护性

- 修改 B1 工作流时，不影响 B2/C1
- 每个文档更聚焦，更容易维护
- 减少了单个文件的复杂度

---

## 📐 设计原则

### 每个工作流文档都包含

1. **强制启动检查** - AI 必须执行的检查流程
2. **AI 行为红线** - 明确禁止和必须做到的事
3. **正确/错误示例** - 对比说明
4. **分步骤流程** - 具体的填写步骤
5. **检查清单** - AI 和 PM 的检查项
6. **下一步引导** - 完成后的后续动作

### 统一的格式

```markdown
---
description: [简短描述]
---

# [文档名称]

**核心原则**：[一句话说明本质]

---

## 🚨 创建时的强制启动检查
## AI 行为红线
## 正确/错误示例
## 分步骤流程
## 检查清单
## 下一步引导
```

---

## 🔄 迁移说明

### 保留 `prd-document-filling.md`

虽然拆分了 B1/B2/C1，但保留 `prd-document-filling.md` 作为：
- 通用填写原则的说明
- 角色定位（AI 是战略思维导师）
- 核心思维框架
- 铁律（禁止一次性生成）

### 建议后续精简

可以将 `prd-document-filling.md` 精简为：
1. 核心原则和角色定位
2. 通用的填写铁律
3. 索引：指向各个独立工作流文档

---

## 📚 使用指南

### AI 如何使用

当用户创建某个文档时，AI 应该查看对应的工作流：

```
用户: "创建 B1"
AI: [查看 prd-b1-planning-draft.md]
    → 执行强制启动检查
    → 开始对话引导
```

### PM 如何使用

PM 可以直接查阅对应的工作流文档：

```bash
# 查看 B1 填写指引
cat .agent/workflows/prd-b1-planning-draft.md

# 查看 B2 填写指引
cat .agent/workflows/prd-b2-planning-breakdown.md

# 查看 C1 填写指引
cat .agent/workflows/prd-c1-requirement-list.md
```

---

## 🚀 后续优化建议

### 1. 为 A0/A1/A2 创建独立工作流

目前 A0/A1/A2 还在 `prd-document-filling.md` 中，可以考虑拆分：

- `prd-a0-product-baseline.md` - A0 产品基础
- `prd-a1-feature-list.md` - A1 功能清单
- `prd-a2-feedback-summary.md` - A2 反馈汇总

### 2. 创建工作流索引

创建一个 `README.md` 或 `INDEX.md` 文件，列出所有工作流文档：

```markdown
# 工作流文档索引

## 项目初始化
- [P0 项目基本信息](prd-p0-project-info.md)

## A 类基线文档
- [A0 产品基础与范围](prd-a0-product-baseline.md)
- [A1 已上线功能清单](prd-a1-feature-list.md)
- [A2 存量反馈汇总](prd-a2-feedback-summary.md)

## R0 基线审视
- [R0 基线审视报告](prd-r0-baseline-review.md)

## B 类规划文档
- [B1 需求规划草案](prd-b1-planning-draft.md)
- [B2 规划拆解与范围界定](prd-b2-planning-breakdown.md)

## R1 规划审视
- [R1 规划审视报告](prd-r1-review.md)

## C 类版本文档
- [C1 版本需求清单](prd-c1-requirement-list.md)

## R2 版本审视
- [R2 版本审视报告](prd-r2-review.md)

## 其他
- [C2 变更追踪](prd-c2-change-tracking.md)
- [对话归档](prd-dialog-archive.md)
```

### 3. 在 CLI 中集成工作流提示

在 CLI 创建文档时，提示对应的工作流文档：

```bash
$ prd plan create B1

✓ B1_需求规划草案.md 创建成功!

📖 工作流指引：.agent/workflows/prd-b1-planning-draft.md

下一步：
1. 查看工作流指引（推荐）
2. 开始填写 B1
```

---

## 📋 总结

### 拆分成果

- ✅ 新建 3 个独立工作流文档（B1/B2/C1）
- ✅ 每个文档 8-12KB，专注单一职责
- ✅ 统一的文档结构和格式
- ✅ 明确的强制检查和行为红线

### 核心价值

1. **结构清晰**：每个文档类型都有独立工作流
2. **易于查找**：AI 和用户可以直接定位
3. **职责明确**：每个工作流只关注一个文档
4. **一致性**：所有重要文档都有专门指引
5. **可维护性**：降低单个文件复杂度

### 下一步

1. 测试新的工作流文档
2. 可选：为 A0/A1/A2 创建独立工作流
3. 可选：创建工作流索引文档
4. 可选：在 CLI 中集成工作流提示

---

**拆分完成时间**: 2025-12-19  
**新建文档数**: 3 个（B1/B2/C1）  
**准备提交**: ✅
