# PRD-CLI 完整总览 (v2.0.0)

> 📅 最后更新: 2026-02-09  
> 📦 当前版本: 2.0.0

---

## 🎯 一句话介绍

**PRD-CLI** 是一个基于 **基线→规划→IT→版本** 流程的产品需求管理 CLI 工具，核心价值是**让 AI 帮你挡住不该写的需求**。

---

## 📊 项目架构

```
prd-cli/
├── bin/                    # CLI 入口
│   └── prd-cli.js
│
├── commands/               # 命令实现
│   ├── init.js             # prd init
│   ├── baseline.js         # prd baseline
│   ├── iteration.js        # prd iteration
│   ├── planning.js         # prd plan
│   ├── it.js               # prd it
│   ├── version.js          # prd version
│   └── ...
│
├── templates/              # 文档模板
│   ├── 业务需求.md
│   └── 技术规格.md
│
├── .agent/workflows/       # AI 工作流
│   ├── prd-代码快照.md
│   ├── prd-需求规划.md
│   ├── prd-业务需求.md
│   └── prd-技术规格.md
│
└── tests/                  # 测试
```

---

## 📝 核心术语

| 术语 | 全称 | 说明 |
|------|------|------|
| **IT** | INVEST User Story | 符合 INVEST 原则的用户故事 |
| **基线** | Baseline | 产品现状基线（产品定义、代码快照、用户反馈） |
| **规划** | Planning | 需求规划和规划冻结 |
| **版本** | Version | 版本发布 |
| **PM** | Product Manager | 产品经理 |

### INVEST 原则

- **I**ndependent（独立的）- 每个 IT 可独立交付
- **N**egotiable（可协商的）- 细节可讨论
- **V**aluable（有价值的）- 对用户有明确价值
- **E**stimable（可估算的）- 开发可评估工作量
- **S**mall（小的）- 可在一个迭代内完成
- **T**estable（可测试的）- 有明确验收标准

---

## 🔄 核心流程

```
┌─────────────────────────────────────────────────────────────────────────┐
│                                                                         │
│   【基线阶段】                                                           │
│   ┌───────────────────────────────────────────────────────────────┐     │
│   │ 产品定义 ──────────→ ✍️ PM 填写                                 │     │
│   │ 代码快照 ──────────→ 🤖 AI 扫描生成                             │     │
│   │ 用户反馈 ──────────→ 🤖 AI 整理                                 │     │
│   └───────────────────────────────────────────────────────────────┘     │
│                                     ↓                                   │
│   【规划阶段】                                                           │
│   ┌───────────────────────────────────────────────────────────────┐     │
│   │ 需求规划 ──────────→ 💬 PM + AI 对话完成                        │     │
│   │                                                               │     │
│   │ prd plan freeze ──→ 🤖 自动审视 → 生成规划冻结                  │     │
│   └───────────────────────────────────────────────────────────────┘     │
│                                     ↓                                   │
│   【IT 阶段】                                                            │
│   ┌───────────────────────────────────────────────────────────────┐     │
│   │ 业务需求 ──────────→ 💬 PM + AI 对话（用户故事+验收标准）        │     │
│   │ 技术规格 ──────────→ 🤖 AI 模板 + 技术负责人补充                │     │
│   └───────────────────────────────────────────────────────────────┘     │
│                                     ↓                                   │
│   【版本阶段】                                                           │
│   ┌───────────────────────────────────────────────────────────────┐     │
│   │ prd version freeze → 🤖 自动审视 → 生成版本发布                 │     │
│   │                    → PM 签名确认                               │     │
│   └───────────────────────────────────────────────────────────────┘     │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 👤 PM 职责表

| 阶段 | PM 需要做什么 |
|------|--------------|
| **产品定义** | ✍️ 手动填写产品边界、红线约束 |
| **需求规划** | 💬 与 AI 对话，决定规划目标和首版范围 |
| **业务需求** | 💬 与 AI 对话，定义用户故事和验收标准 |
| **技术规格** | 👀 审阅（技术细节由技术负责人补充） |
| **版本发布** | ✅ 签名确认 |

---

## ⌨️ 常用命令速查

```bash
# 初始化
prd init <项目名>

# 迭代管理
prd iteration new          # 新建迭代
prd iteration list         # 列出迭代
prd status                 # 查看状态

# 基线阶段
prd baseline create 产品定义
prd baseline create 代码快照
prd baseline create 用户反馈

# 规划阶段
prd plan create            # 创建需求规划
prd plan freeze            # 冻结规划（自动审视）

# IT 阶段
prd it create "功能名"     # 创建 IT（业务需求+技术规格）
prd it list                # 列出所有 IT
prd it show <id>           # 查看 IT 详情

# 版本阶段
prd version freeze         # 冻结版本（自动审视）

# 工具
prd check                  # 规则校验
prd stats                  # 统计报告
prd upgrade                # 更新 workflows
```

---

## 🤖 AI 工作流速查

| 斜杠命令 | 用途 |
|---------|------|
| `/prd-代码快照` | 🤖 扫描代码生成代码快照 |
| `/prd-需求规划` | 需求规划填写引导 |
| `/prd-业务需求` | IT 业务需求编写 |
| `/prd-技术规格` | IT 技术规格编写 |
| `/prd-a2ui-guide` | A2UI 可视化指南 |

---

## 📁 文档结构

```
项目目录/
├── 00_项目总览/
│   └── 项目信息.md             ← PM 填写
├── 01_基线/
│   ├── 产品定义.md             ← PM 填写
│   ├── 代码快照.md             ← 🤖 AI 生成
│   └── 用户反馈.md             ← 🤖 AI 整理
├── 02_迭代记录/
│   └── 第01轮迭代/
│       ├── 需求规划.md         ← PM+AI 对话
│       ├── 规划冻结.md         ← 🤖 自动生成
│       ├── IT/
│       │   └── IT-001-功能名/
│       │       ├── 业务需求.md ← PM+AI 对话
│       │       └── 技术规格.md ← 🤖 模板+技术补充
│       └── 版本发布.md         ← 🤖 自动生成
└── .agent/workflows/           ← AI 工作流
```

---

## 🚨 AI 行为红线

| ❌ AI 禁止 | ✅ AI 应该 |
|-----------|-----------|
| 编造 API/SQL/算法 | 记录技术负责人的回答 |
| 替 PM 决定优先级 | 引导 PM 自己决策 |
| 跳过启动检查 | 严格按流程执行 |
| 一次性填充文档 | 通过对话逐项完成 |
| 在业务需求写技术细节 | 保持业务/技术分离 |

---

## 📈 版本历史

| 版本 | 日期 | 亮点 |
|------|------|------|
| **2.0.0** | 2026-02-09 | 中文命名体系、去除 R0/R1/R2 概念、流程简化 |
| 1.5.0 | 2026-01-22 | IT 架构升级、B 阶段简化、文档减少 45% |
| 1.4.0 | 2025-12-29 | 规则系统、check/stats 命令 |
| 1.1.0 | 2025-12-17 | 完整 A→R→B→C 工作流 |

---

## 🔧 开发与测试

```bash
# 安装依赖
cd prd-cli && npm install

# 本地测试
npm link

# 运行测试
npm test

# 测试覆盖率
npm run test:coverage
```

---

## 📚 相关文档

- [README.md](./README.md) - 项目介绍和命令参考
- [GUIDE.md](./GUIDE.md) - 快速使用指南
- [CHANGELOG.md](./CHANGELOG.md) - 完整更新日志
- [.cursorrules](./.cursorrules) - AI 行为规则

---

**核心价值**: 让 AI 从"陪你写需求"变成"帮你挡住不该写的需求"
