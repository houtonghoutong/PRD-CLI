---
description: B2 规划拆解与范围界定填写工作流
---

# B2 规划拆解与范围界定填写工作流

**核心原则**：用 MECE 原则完整拆解需求，PM 决定优先级和范围。

---

## 🚨 B2 创建时的强制启动检查

**⚠️ AI 绝对禁止在未与 PM 对话的情况下填充 B2 内容！**

### 当检测到 B2 文档被创建时

**AI 必须执行以下流程：**

```
AI: "✅ B2_规划拆解与范围界定.md 已创建。

     在填写 B2 之前，我需要通过对话引导你拆解需求。
     
     🚨 重要原则：
     - AI 不得假设或推测需求项
     - AI 必须让 PM 决定每个需求的优先级
     - AI 必须让 PM 决定首版范围
     - 必须分段确认后才写入
     
     现在，让我们基于 B1 的目标，用 MECE 原则拆解需求。
     
     第一个问题：要达成 B1 的目标，需要哪几个维度的能力？"
```

---

## AI 行为红线（B2 创建时）

**AI 在 B2 创建后绝对禁止：**

1. ❌ **未经对话就列出需求项**
   - 禁止直接输出需求清单
   - 必须引导 PM 拆解需求
   
2. ❌ **替 PM 决定优先级**
   - 禁止自己标记 P0/P1/P2
   - 必须问 PM："哪些是 P0（必须做）？"
   
3. ❌ **替 PM 决定首版范围**
   - 禁止自己决定"首版做哪些"
   - 必须问 PM 确认

4. ❌ **不用 MECE 原则检查**
   - 必须检查需求是否完整穷尽
   - 必须检查需求是否相互独立

**AI 必须做到：**

1. ✅ 引导 PM 用 MECE 原则拆解
2. ✅ 让 PM 决定优先级
3. ✅ 让 PM 决定首版范围
4. ✅ 构建决策矩阵辅助决策

---

## 🎨 A2UI 架构图触发规则（B2 阶段）

**当 PM 在 B2 拆解过程中描述需求结构、模块依赖时，AI 必须主动生成可视化图。**

### 触发信号词

| PM 提到的内容 | AI 触发行为 |
|-------------|-----------|
| "这个需求分为三部分..." | ✅ 主动生成需求结构图 |
| "A 依赖 B，B 依赖 C..." | ✅ 主动生成依赖关系图 |
| "首版做这几个，二版做那几个..." | ✅ 主动生成版本范围图 |
| "P0 有这些，P1 有那些..." | ✅ 主动生成优先级矩阵图 |

### AI 执行流程

```
1. PM 描述需求结构/依赖关系
   ↓
2. AI 识别到结构描述
   ↓
3. AI 主动提议：
   "我注意到您在描述需求结构/依赖关系。
    让我生成一个可视化的图帮助理解。"
   ↓
4. AI 生成 Diagram JSON 并写入 `.a2ui/current.json`
   ↓
5. AI 提示刷新浏览器查看
```

### 架构图组件

使用 `Diagram`, `Layer`, `DiagramGroup`, `Box`, `Arrow` 组件。
详见：`prd-c1-a2ui-guide.md`

### 架构图保存规则

**当 PM 确认架构图后，AI 必须正式保存：**

- **保存位置**：`02_迭代记录/第XX轮迭代/B2_架构图/`
- **生成文件**：`.json` + `.html`
- **嵌入文档**：在 B2 文档中添加链接

---

## B2 的本质：用 MECE 原则完整拆解需求

B2 不是"想做什么就写什么"，而是**基于 B1 目标，用结构化方法完整拆解需求**。

---

## Step 1: 结构化拆解 - MECE 原则

**AI 的第一个问题**：

```
AI: "基于 B1，我建议可以拆解为以下需求项：
    1. XXX
    2. YYY
    3. ZZZ
    你觉得这样拆解合理吗？有遗漏或需要调整的吗？"

PM: [回答]
```

### 示例对话

```
PM: "需要进度指示、保存功能、错误提示"

AI: "好的。我用 MECE 检查一下：
     
     这是按'用户操作流程'拆解的。让我画个树状图：
     
     达成目标
     ├── 创建前（进入流程）
     ├── 创建中（填写过程）
     │   ├── 进度指示 ✅
     │   ├── 保存功能 ✅
     │   └── 错误提示 ✅
     └── 创建后（完成确认）← 这里是否遗漏了？
     
     请问'创建后'的场景需要什么能力？"

PM: "对哦！需要成功提示和跳转"

AI: "好的，补充上。现在我们有 5 个需求项了。"
```

---

## Step 2: 识别 CSF（关键成功因素）

**AI 的第二个问题（必须问）**：

```
AI: "现在我们有 [N] 个需求项。
     
     根据二八法则，哪 20% 的需求决定了 80% 的效果？
     
     请指出 CSF（关键成功因素）。"
```

### AI 必须引导 PM 识别

- 哪些是"必须有的"（没有就失败）
- 哪些是"锦上添花"（有更好，没有也行）

### 识别后立即标记

```
AI: "好的，根据您的判断：
     
     CSF（P0 - 必须做）：
     - 需求项 #1
     - 需求项 #2
     
     重要（P1）：
     - 需求项 #3
     
     可选（P2）：
     - 需求项 #4
     
     请确认这个优先级排序。"
```

---

## Step 3: 范围界定 - 多维决策矩阵

**AI 不应该问："首版做哪些？"**

**AI 应该构建决策矩阵**：

```
AI: "现在我们决定首版范围。我构建一个决策矩阵：
     
     | 需求 | 优先级 | 成本 | 依赖 | 风险 | 建议 |
     |-----|-------|-----|-----|-----|-----|
     | #1  | P0    | 中  | 无   | 低  | 首版 |
     | #2  | P0    | 高  | 依赖#1 | 中 | 首版 |
     | #3  | P1    | 低  | 无   | 低  | 首版 |
     | #4  | P2    | 高  | 无   | 高  | 延后 |
     
     基于这个矩阵，我建议：
     - 首版：#1, #2, #3
     - 延后：#4
     
     您同意吗？还是有调整？"
```

---

## Step 4: 战略导师分析 - 主动挑剔和改进建议

**⚠️ AI 绝对禁止简单的"请确认"走过场！**

### 当 PM 完成需求拆解后

**AI 必须执行以下流程：**

#### 第 1 步：深度分析（必须做）

```
AI: "好的，让我分析一下你的需求拆解：

     📊 结构分析：
     - 总需求数：[N] 个
     - 拆解维度：[列出拆解维度]
     - 开发批次：[M] 批
     
     🔍 让我用 MECE 原则检查..."
```

**AI 必须检查的维度：**

1. **完整性检查（CE）**
   - 是否遗漏了某个场景？
   - 用户旅程是否完整覆盖？
   - 边界情况是否考虑？

2. **独立性检查（ME）**
   - 需求之间是否有重叠？
   - 是否存在依赖关系混乱？

3. **优先级合理性**
   - P0 是否真的是 CSF？
   - 开发顺序是否合理？

4. **范围风险**
   - 首版是否过重？
   - 是否存在范围膨胀？

#### 第 2 步：挑剔质疑（苏格拉底式）

**AI 必须提出至少 3 个挑剔性问题：**

```
AI: "基于分析，我有几个质疑：

     ⚠️ 质疑 1：[具体质疑]
     - 问题描述
     - 潜在风险
     - 需要 PM 澄清的点
     
     ⚠️ 质疑 2：[具体质疑]
     - ...
     
     ⚠️ 质疑 3：[具体质疑]
     - ...
     
     请逐一回答这些质疑。"
```

**示例质疑：**

```
AI: "基于你的拆解，我有以下质疑：

     ⚠️ 质疑 1：第一批并行开发风险
     - 档案扩展 + 多维评估体系并行开发
     - 问题：这两个模块是否有数据依赖？
     - 如果有依赖，并行开发可能导致集成冲突
     - 请澄清：它们真的可以完全独立开发吗？
     
     ⚠️ 质疑 2：AI 能力模块的优先级
     - AI 能力模块被放在第四批
     - 问题：如果 AI 是核心差异化能力，为何这么晚？
     - 潜在风险：前期投入大量开发，最后发现 AI 不可行
     - 请说明：AI 能力是否应该更早验证？
     
     ⚠️ 质疑 3：集成验证放在最后
     - 第五批是集成验证
     - 问题：为什么不在每批都做集成验证？
     - 风险：到最后才发现集成问题，返工成本高
     - 请澄清：是否应该采用持续集成策略？"
```

#### 第 3 步：改进建议（必须提供）

**AI 必须提供 3 个具体的改进建议：**

```
AI: "基于分析和你的回答，我给出 3 个改进建议：

     💡 建议 1：[具体建议]
     - 问题：[当前方案的问题]
     - 建议：[改进方案]
     - 优点：[改进后的好处]
     - 缺点：[可能的代价]
     
     💡 建议 2：[具体建议]
     - ...
     
     💡 建议 3：[具体建议]
     - ...
     
     请选择：
     1. 采纳建议 [X]
     2. 部分采纳（说明采纳哪些）
     3. 不采纳（说明理由）"
```

**示例改进建议：**

```
AI: "基于你的回答，我给出 3 个改进建议：

     💡 建议 1：调整 AI 能力模块优先级
     - 问题：AI 能力放在第四批，风险验证太晚
     - 建议：将 AI 能力拆分为两部分：
       * MVP 验证（第一批）：最小 MVP 验证 AI 可行性
       * 完整实现（第四批）：全功能实现
     - 优点：早期验证技术风险，避免后期返工
     - 缺点：第一批工作量增加 2-3 人天
     
     💡 建议 2：优化并行开发策略
     - 问题：档案扩展和多维评估完全并行可能有风险
     - 建议：采用"错峰并行"：
       * Week 1-2：档案扩展先行，定义数据模型
       * Week 2-4：多维评估跟进，复用数据模型
     - 优点：降低集成风险，保持开发速度
     - 缺点：第一批完成时间延长 1 周
     
     💡 建议 3：增加持续集成检查点
     - 问题：集成验证集中在第五批，风险高
     - 建议：每批结束增加集成检查点：
       * 第一批：档案 + 评估集成测试
       * 第二批：任务管理集成测试
       * 第三批：报告管理集成测试
       * 第四批：AI 能力集成测试
       * 第五批：全流程验证
     - 优点：早发现问题，降低返工成本
     - 缺点：每批增加 1-2 天集成测试时间
     
     请选择你倾向的建议（可多选）：
     1. 采纳建议 1（AI 优先级调整）
     2. 采纳建议 2（错峰并行）
     3. 采纳建议 3（持续集成）
     4. 部分采纳（说明）
     5. 都不采纳（说明理由）"
```

#### 第 4 步：等待 PM 决策

**PM 选择后，AI 确认并写入：**

```
PM: "采纳建议 1 和 3"

AI: "明白。你选择：
     ✅ 建议 1：AI 能力模块优先级调整
     ✅ 建议 3：增加持续集成检查点
     ❌ 建议 2：不采纳错峰并行
     
     我现在将调整后的方案写入 B2：
     
     [执行写入，包含采纳的改进]
     
     已写入。请检查调整后的方案是否准确。"
```

---

## Step 5: 分段写入 B2

**每完成一轮"分析 → 质疑 → 建议 → 决策"，就写入一次：**

```
AI: "好的，我现在把调整后的需求拆解写入 B2。"

[执行写入]

AI: "已写入。请检查是否准确。"

PM: [确认]

AI: "确认无误。继续下一轮分析..."
```

---

## ⚠️ AI 绝对禁止的"走过场"行为

### ❌ 错误示例（走过场）

```
AI: "B2 已创建，请确认：
     - 子需求拆解是否合理？
     - 开发顺序是否正确？
     - 是否有遗漏？"

← 这是走过场！没有分析、没有质疑、没有建议！
```

### ✅ 正确示例（战略导师）

```
AI: "好的，让我分析你的需求拆解：

     📊 结构分析：
     - 6 个需求拆解为 31 个子需求
     - 拆解维度：按功能模块
     - 开发批次：5 批
     
     🔍 MECE 检查：
     - 完整性：✅ 覆盖档案→评估→任务→报告→AI 全流程
     - 独立性：⚠️ 档案扩展与评估体系可能有数据依赖
     
     ⚠️ 我有几个质疑：
     
     质疑 1：AI 能力模块为何放在第四批？
     - 如果 AI 是核心能力，应该更早验证
     - 建议：第一批增加 AI MVP 验证
     
     质疑 2：第五批才做集成验证是否太晚？
     - 建议：每批结束都做集成检查
     
     质疑 3：第一批并行开发的风险？
     - 档案扩展和评估体系是否有依赖？
     
     请逐一回答这些质疑，然后我会给出改进建议。"

← 这才是战略导师！主动分析、挑剔质疑！
```

---

## 🔍 MECE 原则检查清单

### 完全穷尽（Collectively Exhaustive）

AI 必须问：

- [ ] B1 要解决的核心问题，B2 的需求项是否完全覆盖？
- [ ] 是否存在遗漏的场景？
- [ ] 构建覆盖矩阵：

  ```
  场景   | B2 需求项覆盖 | 是否遗漏
  ------|------------|--------
  场景1  | REQ-001    | ✅
  场景2  | 无         | ❌ 遗漏！
  ```

### 相互独立（Mutually Exclusive）

AI 必须检查：

- [ ] B2 的需求项之间是否有重复/交叉？
- [ ] 优先级排序是否合理（CSF 识别）？

---

## 📊 优先级决策指南

### P0（必须做 - CSF）

**特征**：
- 没有就失败
- 核心价值所在
- 高影响、高紧迫

**示例**：
- 用户无法完成核心流程 → P0
- 数据丢失、安全漏洞 → P0

### P1（重要但非立即）

**特征**：
- 有更好，没有也能用
- 提升体验但非核心
- 中影响、中紧迫

**示例**：
- 流程优化（从 5 步降到 3 步）→ P1
- 辅助功能（批量操作）→ P1

### P2（可选）

**特征**：
- 锦上添花
- 低影响、低紧迫
- 可延后到下一轮

**示例**：
- 界面美化 → P2
- 快捷键 → P2

---

## 🗺️ 范围界定决策矩阵

| 需求 | 优先级 | 成本评估 | 依赖关系 | 风险等级 | 首版建议 |
|-----|-------|---------|---------|---------|---------|
| #1  | P0    | 中（5人天）| 无      | 低      | ✅ 首版  |
| #2  | P0    | 高（10人天）| 依赖#1  | 中      | ✅ 首版  |
| #3  | P1    | 低（2人天）| 无      | 低      | ✅ 首版  |
| #4  | P1    | 中（6人天）| 无      | 中      | ⚠️ 评估  |
| #5  | P2    | 高（8人天）| 依赖#3  | 高      | ❌ 延后  |

**决策逻辑**：
1. P0 都进首版（无论成本）
2. P1 看成本和风险
3. P2 一般延后

---

## 💬 苏格拉底式引导示例

### 错误方式（直接给答案）

```
PM: "我想做进度指示、保存、错误提示"
AI: "好的，我给你拆成 5 个需求项"
← 没有引导 PM 思考
```

### 正确方式（引导思考）

```
PM: "我想做进度指示、保存、错误提示"

AI: "好的。让我用 MECE 原则检查一下：
     
     你提到的是'创建中'的需求。
     
     让我画个完整的用户旅程：
     创建前 → 创建中 → 创建后
     
     '创建前'需要什么能力？
     '创建后'需要什么能力？"

PM: [思考并补充]

AI: "很好。现在我们用 MECE 拆解了 X 个维度。
     
     下一个问题：这些需求中，哪些是 CSF？
     （没有就失败的）"
```

```

---

## Step 6: 归档对话（AI 必须执行）

**⚠️ AI 绝对禁止不归档对话！**

### 归档时机

**每完成一轮"分析 → 质疑 → 建议 → 决策"，AI 必须立即归档：**

| 完成环节 | 归档内容 |
|---------|---------|
| Step 1: 需求拆解 | PM 提出的需求、AI 的 MECE 检查、补充的需求 |
| Step 2: 识别 CSF | PM 的优先级判断、AI 的总结确认 |
| Step 3: 范围界定 | 决策矩阵、PM 的选择、讨论过程 |
| Step 4: 战略分析 | AI 的深度分析、3 个质疑、3 个建议、PM 的选择 |

### 归档位置

- **基线阶段**：`98_对话归档/B2_对话记录.md`
- **迭代阶段**：`98_对话归档/第01轮迭代/B2_对话记录.md`

### 归档格式

使用模板：`templates/dialog-template.md`

**归档示例**：

```markdown
## 💬 对话 #1

**时间**: 2025-12-19 16:00:00  
**讨论主题**: 战略导师分析 - 需求拆解质疑

### 🤖 AI 分析
> 📊 结构分析：
> - 6 个需求拆解为 31 个子需求
> - 拆解维度：按功能模块
> - 开发批次：5 批
> 
> 🔍 MECE 检查：
> - 完整性：✅ 覆盖全流程
> - 独立性：⚠️ 档案扩展与评估体系可能有数据依赖

### 🤖 AI 质疑
> ⚠️ 质疑 1：AI 能力模块为何放在第四批？
> - 如果 AI 是核心能力，应该更早验证
> - 建议：第一批增加 AI MVP 验证
> 
> ⚠️ 质疑 2：第五批才做集成验证是否太晚？
> 
> ⚠️ 质疑 3：第一批并行开发的风险？

### 🧑 PM 回答
> 1. AI 能力确实是核心，你说得对
> 2. 集成验证应该每批都做
> 3. 档案和评估有数据模型依赖

### 🤖 AI 建议
> 💡 建议 1：调整 AI 能力模块优先级
> - 问题：风险验证太晚
> - 建议：第一批增加 AI MVP
> - 优点：早验证风险
> - 缺点：增加 2-3 人天
> 
> 💡 建议 2：优化并行开发策略
> 💡 建议 3：增加持续集成检查点

### ✅ PM 选择
> 采纳建议 1 和 3

### 📝 AI 执行
> 已将调整后的方案写入 B2，包含：
> - AI 能力模块优先级调整
> - 持续集成检查点

---
```

### AI 归档检查清单

在写入 B2 内容前，AI 必须确认：

- [ ] 已记录需求拆解过程
- [ ] 已记录 AI 的深度分析
- [ ] 已记录 AI 的 3 个质疑
- [ ] 已记录 PM 对质疑的回答
- [ ] 已记录 AI 的 3 个改进建议（含优缺点）
- [ ] 已记录 PM 的选择（采纳哪些建议）
- [ ] 已标注时间戳
- [ ] 已写入对话归档文件

---

## 🔄 B2 完成后的下一步

```
AI: "B2_规划拆解与范围界定已完成。
     
     检查清单：
     - [✓] 需求项用 MECE 原则拆解
     - [✓] CSF 已识别并标记为 P0
     - [✓] 首版范围已明确
     - [✓] 所有决策都由 PM 确认
     
     统计：
     - 总需求项：[N] 个
     - 首版包含：[M] 个
     - 延后项目：[K] 个
     
     下一步：
     1. 执行 R1 规划审视
        运行：prd review r1
     
     2. 或者先修改 B2
        如需修改，请告诉我要调整的部分
     
     您选择哪个？"
```

---

## ⚠️ 常见错误与纠正

### 错误 1：范围膨胀

**症状**：首版包含了 15 个以上需求项

**AI 应该质疑**：

```
AI: "⚠️ 我注意到首版包含了 [N] 个需求项。
     
     根据经验，首版超过 10-12 项容易失控。
     
     建议：
     1. 重新识别 CSF（真正的 P0）
     2. 将部分 P1 延后到第二版
     
     请重新评估优先级。"
```

### 错误 2：需求重复

**症状**：多个需求项描述类似的能力

**AI 应该指出**：

```
AI: "⚠️ 需求 #2 和 #5 看起来有重叠：
     - #2: XX功能
     - #5: YY功能
     
     请问这两个是同一个需求吗？
     还是有区别？"
```

### 错误 3：CSF 未识别

**症状**：所有需求都标记为 P0

**AI 应该拷问**：

```
AI: "⚠️ 所有需求都是 P0 吗？
     
     让我们重新思考：
     - 如果只能做 1 个，你会选哪个？
     - 如果时间减半，哪些可以延后？
     
     这样可以识别真正的 CSF。"
```

---

## 📋 AI 自查清单

每完成 5 个需求项，AI 应该自问：

- [ ] 这些需求是否相互独立？（ME）
- [ ] 是否遗漏了某个场景？（CE）
- [ ] 优先级是 PM 决定的吗？
- [ ] 首版范围是 PM 决定的吗？
- [ ] 我构建了决策矩阵吗？

---

## ⚠️ AI 行为红线

### AI 绝对禁止

1. ❌ 未经对话就列出需求项
2. ❌ 替 PM 决定优先级
3. ❌ 替 PM 决定首版范围
4. ❌ 不用 MECE 检查完整性
5. ❌ 一次性写完所有需求

### AI 必须做到

1. ✅ 引导 PM 用 MECE 拆解
2. ✅ 让 PM 决定所有优先级
3. ✅ 构建决策矩阵辅助决策
4. ✅ 每 3 个需求就保存一次
5. ✅ 检查范围膨胀风险

---

**本工作流确保需求拆解的完整性和合理性，避免范围失控！**
