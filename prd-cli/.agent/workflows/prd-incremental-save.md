# PRD 分段写入工作流

**核心原则**：确认一个，写入一个。不要把所有内容累积在对话中！

---

## 🚨 上下文丢失风险

AI 的对话上下文是有限的。如果：
- 讨论了 20+ 个需求项
- 都只停留在对话里
- 最后才一次性写入文件

**会发生**：
- 早期讨论的内容被遗忘
- PM 确认过的决策丢失
- 最终文档不完整

---

## ✅ 分段写入策略

### 铁律：每确认 1-3 个需求项，就写入文件一次！

**正确做法**：
```
讨论需求项 #1 → PM 确认 → 立即写入 B1/B2 → 记录归档
讨论需求项 #2 → PM 确认 → 立即写入 B1/B2 → 记录归档
讨论需求项 #3 → PM 确认 → 立即写入 B1/B2 → 记录归档
...
```

**错误做法**：
```
讨论需求项 #1 → PM 确认 → 继续聊
讨论需求项 #2 → PM 确认 → 继续聊
...
讨论需求项 #20 → PM 确认 → 最后一次性写入 ❌ 可能丢失内容！
```

---

## 📝 具体执行方法

### B1 填写时的分段写入

**第1步：核心问题（立即写入）**
```
PM: "我们要解决创建流程复杂的问题"
AI: "好的，我现在把这个核心问题写入 B1 的第 1 部分。"
[执行写入]
AI: "已写入。继续下一项..."
```

**第2步：使用场景（立即写入）**
```
PM: "主要场景是年初创建 BP"
AI: "理解，我现在把使用场景写入 B1 的第 2 部分。"
[执行写入]
AI: "已写入。继续下一项..."
```

**第3步："不做什么"（立即写入）**
```
PM: "这次不做审批流程"
AI: "好的，写入 B1 的第 3 部分。"
[执行写入]
```

### B2 填写时的分段写入

**每 1-3 个需求项就写入一次**：

```
AI: "需求项 #1、#2、#3 已确认。我现在把它们写入 B2。"
[执行写入]
AI: "已写入。继续讨论 #4-#6..."

AI: "需求项 #4、#5、#6 已确认。我现在把它们写入 B2。"
[执行写入]
AI: "已写入。继续..."
```

---

## 🔧 里程碑保存点

### 在以下时机必须保存文件：

1. **完成一个章节时**
   - 完成"核心问题"→ 保存
   - 完成"使用场景"→ 保存
   - 完成"范围界定"→ 保存

2. **确认 3 个需求项时**
   - 每 3 个需求项 → 保存一次

3. **讨论超过 10 轮对话时**
   - 即使还在讨论中 → 先保存已确认的内容

4. **PM 说"这部分确定了"时**
   - 立即保存

5. **切换讨论主题时**
   - 保存上一个主题的内容

---

## 📋 AI 自查清单

每隔 5 轮对话，AI 应该自问：

- [ ] 我有多少已确认但未写入文件的内容？
- [ ] 如果现在上下文丢失，哪些 PM 决策会丢？
- [ ] 是否应该先保存一下？

如果未写入的内容超过 3 项，**立即保存**！

---

## 💡 实用提示

### AI 应该主动说：

```
"我们已经确认了 5 个需求项。为了避免信息丢失，
我现在把它们写入 B2 文件。请稍等..."

[执行写入]

"已保存！我们可以继续讨论剩余的需求项。"
```

### AI 可以创建"临时存档"：

如果不确定 PM 是否最终确认，可以先写入临时文件：
```
98_对话归档/第01轮迭代/B2_讨论进度.md
```

等 PM 最终确认后，再整理到正式 B2 文件。

---

## ⚠️ 特别提醒

### 长会话风险信号：

1. **对话超过 20 轮** → 必须检查是否有未保存内容
2. **讨论了超过 5 个需求** → 必须分段保存
3. **PM 说"刚才确认过的"** → 说明 AI 可能已经忘了

### 补救措施：

如果发现可能遗漏了之前讨论的内容：
```
AI: "为了确保信息完整，请让我回顾一下我们之前确认的内容：
     1. ...
     2. ...
     请确认这些是否准确？有遗漏吗？"
```

---

**本工作流确保所有讨论内容都能被及时保存，不会因上下文限制而丢失！**
