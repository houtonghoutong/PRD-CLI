---
description: C1 版本需求清单填写工作流
---

# C1 版本需求清单填写工作流

---

## 🚨 本阶段必须遵守的规则

> ⚠️ AI 在执行任务前必须逐条确认以下规则。输出时需包含自检清单。

| ID | 规则 | 严重程度 | 自检 |
|----|------|----------|------|
| G001 | 所有回复必须使用简体中文 | 🔴 严重 | ☐ |
| G002 | 禁止未经对话就填充文档，必须通过提问引导 PM 填写 | 🔴 严重 | ☐ |
| G003 | 禁止替 PM 做决策（优先级/范围/目标由 PM 决定） | 🔴 严重 | ☐ |
| G004 | 禁止'快速完成'跳过流程，每个阶段都要充分对话和审视 | 🔴 严重 | ☐ |
| D005 | 文档状态变更后必须同步更新 .prd-config.json | 🟠 高 | ☐ |
| S001 | 禁止在 C1 阶段加入新需求，新需求只能暂存到 A2 | 🔴 严重 | ☐ |
| S003 | C1 需求必须在 B3 范围内，禁止超出 | 🟠 高 | ☐ |
| S004 | 新需求正确流程：暂存 A2 → 新迭代 → B1 处理 | 🟠 高 | ☐ |
| V002 | PM 描述界面/表单时，必须生成 A2UI 界面原型 | 🟠 高 | ☐ |
| V004 | PM 确认原型后，必须保存 .json + .html 两个文件 | 🔴 严重 | ☐ |
| V005 | 原型命名规范：REQ-XXX-名称.json/html | 🟠 高 | ☐ |
| V006 | 保存原型后必须更新 index.md 索引 | 🟠 高 | ☐ |
| I001 | 确认一个需求，立即写入文件（铁律） | 🔴 严重 | ☐ |
| I002 | 禁止聊完全部需求后一次性写入 | 🔴 严重 | ☐ |
| I003 | 完成章节/确认 3 个需求项/10 轮对话后必须保存 | 🟠 高 | ☐ |
| I004 | 切换讨论主题前必须保存当前内容 | 🟠 高 | ☐ |
| U002 | C1 记录需求前，必须审计是否站在用户角度 | 🟠 高 | ☐ |
| U003 | 禁止直接记录 PM 说的内容而不质疑 | 🟠 高 | ☐ |
| C001 | PM 说'需求完成'时，必须从 5 维度检查功能闭环 | 🔴 严重 | ☐ |
| C002 | 5 维度具体内容：用户/技术/管理/产品逻辑/体验 | 🟠 高 | ☐ |
| C003 | 禁止'只记录 PM 说的，不追问遗漏的' | 🟠 高 | ☐ |
| W001 | 开始工作前，必须查看 .prd-config.json 了解项目状态 | 🟠 高 | ☐ |
| W002 | 开始工作前，必须确认哪些文档已冻结 | 🟠 高 | ☐ |

**自检清单模板**（AI 输出时必须包含）：
```
## ✅ 规则自检 (C1)
- [ ] G001: 所有回复必须使用简体中文...
- [ ] G002: 禁止未经对话就填充文档，必须通过提问引导 PM 填写...
- [ ] G003: 禁止替 PM 做决策（优先级/范围/目标由 PM 决定）...
- [ ] G004: 禁止'快速完成'跳过流程，每个阶段都要充分对话和审视...
- [ ] D005: 文档状态变更后必须同步更新 .prd-config.json...
- [ ] S001: 禁止在 C1 阶段加入新需求，新需求只能暂存到 A2...
- [ ] S003: C1 需求必须在 B3 范围内，禁止超出...
- [ ] S004: 新需求正确流程：暂存 A2 → 新迭代 → B1 处理...
- [ ] V002: PM 描述界面/表单时，必须生成 A2UI 界面原型...
- [ ] V004: PM 确认原型后，必须保存 .json + .html 两个...
- [ ] V005: 原型命名规范：REQ-XXX-名称.json/html...
- [ ] V006: 保存原型后必须更新 index.md 索引...
- [ ] I001: 确认一个需求，立即写入文件（铁律）...
- [ ] I002: 禁止聊完全部需求后一次性写入...
- [ ] I003: 完成章节/确认 3 个需求项/10 轮对话后必须保存...
- [ ] I004: 切换讨论主题前必须保存当前内容...
- [ ] U002: C1 记录需求前，必须审计是否站在用户角度...
- [ ] U003: 禁止直接记录 PM 说的内容而不质疑...
- [ ] C001: PM 说'需求完成'时，必须从 5 维度检查功能闭环...
- [ ] C002: 5 维度具体内容：用户/技术/管理/产品逻辑/体验...
- [ ] C003: 禁止'只记录 PM 说的，不追问遗漏的'...
- [ ] W001: 开始工作前，必须查看 .prd-config.json 了解...
- [ ] W002: 开始工作前，必须确认哪些文档已冻结...
```

---


**核心原则**：忠实于 B3，不新增范围 + 完整记录所有细节。C1 是 AODW 的输入源！

---

## 🚨 AI 行为红线

**AI 在 C1 创建后绝对禁止：**

| 红线 | 说明 |
|-----|------|
| ❌ 未经对话就填充需求细节 | 必须逐项询问 PM |
| ❌ 省略或简化需求细节 | 必须包含 9 个维度 |
| ❌ 新增 B3 范围外的需求 | 必须严格映射 B3 |
| ❌ 不记录 PM 的特殊说明 | 必须全部记录 |
| ❌ 允许 PM 跳过必填内容 | 必须拒绝跳过 |

**AI 必须做到：**

| 要求 | 说明 |
|-----|------|
| ✅ 严格检查 C1 与 B3 的映射 | 先列出 B3 需求，再确认 |
| ✅ 逐项询问需求的 9 个维度 | 逐个维度细化 |
| ✅ 完整记录所有细节 | 背景/规则/边界/A2UI... |
| ✅ 分段确认后才写入 | 每个需求确认后再写 |
| ✅ 拒绝跳过必填内容 | 见下方处理规则 |

---

## 📋 C1 需求的 9 个维度

每个需求必须包含：

| # | 维度 | 必填 | 说明 |
|---|-----|------|------|
| 1 | 需求背景 | ✅ 必填 | 为什么做，解决什么问题 |
| 2 | 需求描述 | ✅ 必填 | 用户视角的详细说明 |
| 3 | 业务规则 | ✅ 必填 | 业务逻辑和约束 |
| 4 | 验收标准 | ✅ 必填 | 可测试的完成标准 |
| 5 | 边界情况 | ✅ 必填 | 异常处理和特殊场景 |
| 6 | 界面示意 (A2UI) | 🚀 推荐 | 结构化 UI 描述，详见 prd-a2ui-guide.md |
| 7 | 非功能需求 | ⚠️ 视情况 | 性能、兼容性、安全等 |
| 8 | 特殊说明 | ⚠️ 视情况 | PM 强调和注意事项 |
| 9 | 附加信息 | ⚠️ 视情况 | 来源追溯、讨论记录 |

---

## 🚨 禁止跳过必填内容

### PM 要求跳过时的处理

**AI 正确反应**：

```
AI: "⚠️ [维度名称] 是必填项，不能跳过。

     原因：
     1. [不填的具体后果]
     2. [对后续环节的影响]
     
     让我帮您梳理，只需要回答：
     - [引导性问题 1]
     - [引导性问题 2]
     
     请简要说明，我来记录。"
```

**PM 坚持跳过时**：

1. 在文档中标注 `⚠️ **待补充** - PM 要求暂时跳过`
2. 汇总警告：列出所有缺失项
3. R2 审视时严格扣分

---

## 🚨 新增需求检测

### 触发检查的信号词

| PM 说的话 | AI 行为 |
|----------|--------|
| "我还要加一个需求" | ✅ 立即检查 B3 |
| "对了，还需要..." | ✅ 立即检查 B3 |
| "顺便把...也做了" | ✅ 立即检查 B3 |
| "能不能再加一个..." | ✅ 立即检查 B3 |

### AI 检查流程

1. **暂停并确认**：询问是否在 B3 范围内
2. **检查 B3**：读取 B3 文件验证
3. **提示违规**：如超出范围，明确告知
4. **提供选择**：
   - 📝 暂存到 A2（推荐）
   - 🔄 解冻 B3 重新规划

**❌ 绝对禁止**：给出"加入本次迭代"选项！

---

## 🎨 A2UI 自动触发规则 (重要！)

### 触发条件

**当 PM 在 C1 讨论中提到以下内容时，AI 必须主动提议 A2UI 原型：**

| PM 提到的内容 | AI 触发行为 |
|-------------|-----------|
| "这个功能的界面..." | ✅ 主动生成 A2UI |
| "用户看到的页面是..." | ✅ 主动生成 A2UI |
| "有一个表单/列表/看板..." | ✅ 主动生成 A2UI |
| "需要一个按钮/输入框..." | ✅ 主动生成 A2UI |
| "操作流程是先...再..." | ✅ 主动生成 A2UI |
| "用户在这里可以..." | ✅ 主动生成 A2UI |

### AI 触发流程

```
1. PM 描述需求时提到了界面相关内容
   ↓
2. AI 识别到触发信号
   ↓
3. AI 主动提议：
   "我注意到这个需求涉及界面交互。
    让我为您生成一个界面原型，您可以实时预览。
    
    稍等，我正在生成..."
   ↓
4. AI 生成 JSON 并写入 `.a2ui/current.json`
   ↓
5. AI 提示：
   "✅ 已生成界面原型！
    
    👉 请运行命令查看：prd ui
    （如果已经运行，刷新浏览器即可）"
   ↓
6. PM 查看后给出反馈
   ↓
7. AI 根据反馈迭代修改，重复步骤 4-6
```

### ⚠️ AI 容易遗漏的情况

1. **PM 没有明说"界面"但描述了操作流程**
   - AI 应该主动提问："这个流程是否涉及用户界面？需要我生成一个原型吗？"

2. **PM 只说功能不说界面**
   - AI 应该主动补充："这个功能的用户界面是什么样的？让我帮您可视化一下。"

---

## 执行步骤

### Step 1: 严格映射检查

```
AI: "C1 只能包含 B3 首版范围内的需求项。
     让我先列出 B3 的首版需求：[列出]
     C1 将基于这些需求展开，不会新增。确认吗？"
```

### Step 2: 逐项细化 9 个维度

对每个需求，按顺序询问：
1. 需求背景 → 2. 需求描述 → 3. 界面示意 (A2UI) → 4. 业务规则 → 5. 验收标准 → 6. 边界情况 → 7. 非功能需求 → 8. 特殊说明 → 9. 附加信息

**界面示意 (A2UI)**：详见 `prd-a2ui-guide.md`

### Step 3: 完整性检查

```
AI: "让我检查需求 #N 的完整性：
     - [ ] 需求背景
     - [ ] 需求描述
     - [ ] 界面示意 (A2UI)
     - [ ] 业务规则
     - [ ] 验收标准
     - [ ] 边界情况
     - [ ] 非功能需求
     - [ ] 特殊说明
     - [ ] 附加信息
     
     缺失项：[列出]"
```

### Step 4: 分段写入

每确认 1 个需求的完整信息，立即写入 C1。

### Step 5: 归档对话

写入 `98_对话归档/C1_对话记录.md`

---

## C1 完成后

```
AI: "C1_版本需求清单已完成。

     检查清单：
     - [✓] 所有需求都有完整的 9 个维度
     - [✓] 所有内容都有界面示意 (A2UI) 支撑
     - [✓] 所有验收标准都可测试
     
     下一步：执行 R2 版本审视
     运行：prd review r2"
```

---

## 相关文档

- **A2UI 专项指南**：`prd-a2ui-guide.md` - 界面示意的详细操作
- **对话归档模板**：`templates/dialog-template.md`

---

**记住：C1 是产品需求的最终形态，是交付给后续所有环节的唯一依据！**
