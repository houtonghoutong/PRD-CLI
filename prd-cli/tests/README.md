# æµ‹è¯•æ¡†æ¶ä½¿ç”¨æŒ‡å—

**åˆ›å»ºæ—¶é—´**: 2025-12-22  
**æµ‹è¯•æ¡†æ¶**: Jest  

---

## ğŸ“ æµ‹è¯•ç›®å½•ç»“æ„

```
tests/
â”œâ”€â”€ unit/                    # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ baseline.test.js    # åŸºçº¿å‘½ä»¤æµ‹è¯•
â”‚   â””â”€â”€ iteration.test.js   # è¿­ä»£å‘½ä»¤æµ‹è¯•
â”œâ”€â”€ integration/            # é›†æˆæµ‹è¯•
â”‚   â””â”€â”€ workflow-r0-r1.test.js  # R0-R1æµç¨‹æ§åˆ¶æµ‹è¯•
â”œâ”€â”€ e2e/                    # ç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆæœªæ¥ï¼‰
â”œâ”€â”€ fixtures/               # æµ‹è¯•æ•°æ®ï¼ˆæœªæ¥ï¼‰
â””â”€â”€ helpers/                # æµ‹è¯•è¾…åŠ©å‡½æ•°
    â””â”€â”€ test-helper.js      # é€šç”¨æµ‹è¯•å·¥å…·
```

---

## ğŸš€ è¿è¡Œæµ‹è¯•

### è¿è¡Œæ‰€æœ‰æµ‹è¯•
```bash
npm test
```

### è¿è¡Œç‰¹å®šç±»å‹çš„æµ‹è¯•
```bash
# åªè¿è¡Œå•å…ƒæµ‹è¯•
npm run test:unit

# åªè¿è¡Œé›†æˆæµ‹è¯•
npm run test:integration
```

### ç›‘è§†æ¨¡å¼ï¼ˆå¼€å‘æ—¶ä½¿ç”¨ï¼‰
```bash
npm run test:watch
```

### æŸ¥çœ‹è¦†ç›–ç‡
```bash
npm run test:coverage
```

---

## âœ… å½“å‰æµ‹è¯•è¦†ç›–

### å•å…ƒæµ‹è¯•

#### baseline.test.js
- âœ… A0 æ–‡æ¡£åˆ›å»º
- âœ… A0 æ–‡æ¡£å†…å®¹éªŒè¯
- âœ… A1 æ–‡æ¡£åˆ›å»º
- âœ… R0 æ–‡æ¡£åˆ›å»º

#### iteration.test.js
- âœ… ç¬¬ä¸€è½®è¿­ä»£åˆ›å»º
- âœ… R1 å¯åŠ¨æ¡ä»¶æ£€æŸ¥ç”Ÿæˆ
- âœ… å¤šè½®è¿­ä»£åˆ›å»º

### é›†æˆæµ‹è¯•

#### workflow-r0-r1.test.jsï¼ˆæ ¸å¿ƒï¼‰
- âœ… R0 å®Œæˆåä¸è‡ªåŠ¨åˆ›å»º R1 å®¡è§†
- âœ… R0 å®Œæˆåä¸è‡ªåŠ¨åˆ›å»ºè¿­ä»£
- âœ… åˆ›å»ºè¿­ä»£ç”Ÿæˆ R1 å¯åŠ¨æ¡ä»¶æ£€æŸ¥
- âœ… R1 å¯åŠ¨æ¡ä»¶åŒ…å«3ä¸ªå¿…è¦æ¡ä»¶
- âœ… æ²¡æœ‰è¿­ä»£æ—¶ R1 å®¡è§†å¤±è´¥
- âœ… æ²¡æœ‰ B1/B2 æ—¶ R1 å®¡è§†å¤±è´¥
- âœ… å®Œæ•´æ­£ç¡®æµç¨‹ï¼šè¿­ä»£ â†’ B1 â†’ B2 â†’ R1 å®¡è§†
- âœ… éªŒè¯ä¸¤ä¸ª R1 æ–‡æ¡£éƒ½å­˜åœ¨ä¸”ä¸åŒ
- âš ï¸ é”™è¯¯æµç¨‹é˜»æ­¢ï¼ˆéƒ¨åˆ†ï¼‰

---

## ğŸ“ ç¼–å†™æ–°æµ‹è¯•

### 1. ä½¿ç”¨ TestHelper

```javascript
const TestHelper = require('../helpers/test-helper');

describe('My Test Suite', () => {
  let testDir;
  let projectDir;

  beforeEach(async () => {
    testDir = await TestHelper.createTempDir('my-test');
    projectDir = await TestHelper.initProject(testDir);
  });

  afterEach(async () => {
    await TestHelper.cleanup(testDir);
  });

  test('should do something', async () => {
    // ä½¿ç”¨ TestHelper çš„æ–¹æ³•
    await TestHelper.createBaseline(projectDir, 'A0');
    
    const exists = await TestHelper.fileExists(
      projectDir,
      '01_äº§å“åŸºçº¿/A0_äº§å“åŸºç¡€ä¸èŒƒå›´è¯´æ˜.md'
    );
    
    expect(exists).toBe(true);
  });
});
```

### 2. TestHelper æä¾›çš„æ–¹æ³•

```javascript
// é¡¹ç›®ç®¡ç†
TestHelper.createTempDir(prefix)           // åˆ›å»ºä¸´æ—¶ç›®å½•
TestHelper.cleanup(dir)                    // æ¸…ç†ç›®å½•
TestHelper.initProject(testDir, name)      // åˆå§‹åŒ–é¡¹ç›®

// å‘½ä»¤æ‰§è¡Œ
TestHelper.execCommand(command, dir)       // æ‰§è¡Œä»»æ„å‘½ä»¤
TestHelper.createBaseline(dir, type)       // åˆ›å»ºåŸºçº¿
TestHelper.createIteration(dir)            // åˆ›å»ºè¿­ä»£
TestHelper.createPlan(dir, type)           // åˆ›å»ºè§„åˆ’
TestHelper.review(dir, type)               // æ‰§è¡Œå®¡è§†

// æ–‡ä»¶æ“ä½œ
TestHelper.fileExists(dir, path)           // æ£€æŸ¥æ–‡ä»¶
TestHelper.readFile(dir, path)             // è¯»å–æ–‡ä»¶
```

---

## ğŸ› è°ƒè¯•æµ‹è¯•

### è¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶
```bash
npx jest tests/unit/baseline.test.js
```

### è¿è¡Œç‰¹å®šæµ‹è¯•ç”¨ä¾‹
```bash
npx jest -t "åº”è¯¥æˆåŠŸåˆ›å»º A0 æ–‡æ¡£"
```

### æŸ¥çœ‹è¯¦ç»†è¾“å‡º
```bash
npx jest --verbose
```

---

## ğŸ“Š æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡

| æµ‹è¯•ç±»å‹ | å½“å‰è¦†ç›– | ç›®æ ‡è¦†ç›– |
|---------|---------|---------|
| å‘½ä»¤åŠŸèƒ½ | 40% | 100% |
| æ–‡ä»¶ç”Ÿæˆ | 60% | 90% |
| æµç¨‹æ§åˆ¶ | 80% | 80% |
| é”™è¯¯å¤„ç† | 20% | 70% |

---

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

### çŸ­æœŸï¼ˆæœ¬å‘¨ï¼‰
- [ ] æ·»åŠ  planning å‘½ä»¤æµ‹è¯•
- [ ] æ·»åŠ  version å‘½ä»¤æµ‹è¯•
- [ ] æ·»åŠ  review å‘½ä»¤æµ‹è¯•
- [ ] æé«˜é”™è¯¯å¤„ç†æµ‹è¯•è¦†ç›–ç‡

### ä¸­æœŸï¼ˆä¸‹å‘¨ï¼‰
- [ ] æ·»åŠ ç«¯åˆ°ç«¯æµ‹è¯•
- [ ] å®ç°å·¥ä½œæµè§„åˆ™æ£€æŸ¥å™¨
- [ ] æ·»åŠ å¿«ç…§æµ‹è¯•
- [ ] æé«˜æ•´ä½“è¦†ç›–ç‡åˆ° 70%

### é•¿æœŸ
- [ ] é…ç½® CI/CD è‡ªåŠ¨æµ‹è¯•
- [ ] æ·»åŠ æ€§èƒ½æµ‹è¯•
- [ ] æ·»åŠ  AI è¡Œä¸ºå¥‘çº¦æµ‹è¯•

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æµ‹è¯•éš”ç¦»**: æ¯ä¸ªæµ‹è¯•éƒ½åœ¨ç‹¬ç«‹çš„ä¸´æ—¶ç›®å½•ä¸­è¿è¡Œ
2. **è‡ªåŠ¨æ¸…ç†**: afterEach ä¼šè‡ªåŠ¨æ¸…ç†æµ‹è¯•ç›®å½•
3. **è¶…æ—¶è®¾ç½®**: é»˜è®¤ 30 ç§’è¶…æ—¶ï¼ˆå¯åœ¨ jest é…ç½®ä¸­è°ƒæ•´ï¼‰
4. **è·¯å¾„é—®é¢˜**: ä½¿ç”¨ TestHelper æä¾›çš„æ–¹æ³•å¤„ç†è·¯å¾„

---

## ğŸ” å¸¸è§é—®é¢˜

### Q: æµ‹è¯•å¤±è´¥äº†æ€ä¹ˆåŠï¼Ÿ
A: 
1. æŸ¥çœ‹é”™è¯¯ä¿¡æ¯
2. è¿è¡Œå•ä¸ªæµ‹è¯•å®šä½é—®é¢˜
3. ä½¿ç”¨ `--verbose` æŸ¥çœ‹è¯¦ç»†è¾“å‡º
4. æ£€æŸ¥ä¸´æ—¶ç›®å½•ï¼ˆæµ‹è¯•å¤±è´¥æ—¶ä¸ä¼šè‡ªåŠ¨æ¸…ç†ï¼‰

### Q: å¦‚ä½•è·³è¿‡æŸä¸ªæµ‹è¯•ï¼Ÿ
A: å°† `test()` æ”¹ä¸º `test.skip()`

### Q: å¦‚ä½•åªè¿è¡ŒæŸä¸ªæµ‹è¯•ï¼Ÿ
A: å°† `test()` æ”¹ä¸º `test.only()`

---

**è®°ä½**: å¥½çš„æµ‹è¯•æ˜¯æœ€å¥½çš„æ–‡æ¡£ï¼
